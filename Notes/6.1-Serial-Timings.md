# 1200 images
```
$./cnn-cifar10 
Serial Code
CNN for 1200 images
Loading input batch 1...
Load Data time:0.029644 seconds
Create Network time:0.000013 seconds
Load Network Parameters time:0.008368 seconds
Create Ouputs time:0.000046 seconds

Net Forward total time:34.827892 seconds
  Conv: 34.467251 seconds
  ReLU: 0.138085 seconds
  Pool: 0.194502 seconds
  FC:   0.013239 seconds
  Softmax: 0.001524 seconds

Net Accuracy: 78.25 % 
Net Accuracy time:0.000085 seconds
Free memory time:0.001519 seconds
Total time:34.867567 seconds
END!	
```

# 13400 images

```
$ ./cnn-cifar10 
Serial Code
CNN for 13400 images
Loading input batch 1...
Loading input batch 2...
Load Data time:0.254037 seconds
Create Network time:0.000011 seconds
Load Network Parameters time:0.008214 seconds
Create Ouputs time:0.000147 seconds

Net Forward total time:536.529739 seconds
    Time for conv1: 172.819551 seconds
    Time for relu1: 1.440136 seconds
    Time for pool1: 2.110989 seconds
    Time for conv2: 277.679823 seconds
    Time for relu2: 0.418876 seconds
    Time for pool2: 0.646626 seconds
    Time for conv3: 80.693601 seconds
    Time for relu3: 0.122049 seconds
    Time for pool3: 0.186779 seconds
    Time for fc: 0.198928 seconds
    Time for softmax: 0.023067 seconds

  Conv: 531.192975 seconds
  ReLU: 1.981061 seconds
  Pool: 2.944394 seconds
  FC:   0.198928 seconds
  Softmax: 0.023067 seconds

Net Accuracy: 78.71 % 
Net Accuracy time:0.001638 seconds
Free memory time:0.024933 seconds
Total time:536.818719 seconds
END!
```
# 25600 images
```
$ ./cnn-cifar10 
Serial Code
CNN for 25600 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Load Data time:0.873160 seconds
Create Network time:0.000022 seconds
Load Network Parameters time:0.018821 seconds
Create Ouputs time:0.000363 seconds

Net Forward total time:851.306370 seconds
  Conv: 842.637947 seconds
  ReLU: 3.273687 seconds
  Pool: 4.723809 seconds
  FC:   0.319371 seconds
  Softmax: 0.036922 seconds

Net Accuracy: 78.67 % 
Net Accuracy time:0.001877 seconds
Free memory time:0.027835 seconds
Total time:852.228448 seconds
END!
```

# 37800 images
```
$ ./cnn-cifar10 
Serial Code
CNN for 37800 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Load Data time:0.716455 seconds
Create Network time:0.000014 seconds
Load Network Parameters time:0.015933 seconds
Create Ouputs time:0.000367 seconds

Net Forward total time:1245.024988 seconds
    Time for conv1: 401.209395 seconds
    Time for relu1: 3.561941 seconds
    Time for pool1: 4.984796 seconds
    Time for conv2: 643.743547 seconds
    Time for relu2: 1.030007 seconds
    Time for pool2: 1.520103 seconds
    Time for conv3: 187.239154 seconds
    Time for relu3: 0.300406 seconds
    Time for pool3: 0.440653 seconds
    Time for fc: 0.471294 seconds
    Time for softmax: 0.055039 seconds

  Conv: 1232.192096 seconds
  ReLU: 4.892354 seconds
  Pool: 6.945552 seconds
  FC:   0.471294 seconds
  Softmax: 0.055039 seconds

Net Accuracy: 78.76 % 
Net Accuracy time:0.003326 seconds
Free memory time:0.046129 seconds
Total time:1245.807212 seconds
END!
```

# 50.000 images
```
$ ./cnn-cifar10 
Serial Code
CNN for 50000 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Loading input batch 5...
Load Data time:2.688974 seconds
Create Network time:0.000024 seconds
Load Network Parameters time:0.030224 seconds
Create Ouputs time:0.001176 seconds

Net Forward total time:1761.983244 seconds
  Conv: 1744.045365 seconds
  ReLU: 6.785088 seconds
  Pool: 9.765129 seconds
  FC:   0.661414 seconds
  Softmax: 0.078102 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.004978 seconds
Free memory time:0.056185 seconds
Total time:1764.764805 seconds
END!	
```
# Profiling

>[!WARNING]
>krilov100 - nlp

```
$ make
nvc -Minfo=all -c11 -Wall -Wextra -march=native -g -pg -o cnn-cifar10-prof main_serial.c layers_serial.c malloc2D.c
main_serial.c:
layers_serial.c:
conv_forward:
     62, FMA (fused multiply-add) instruction(s) generated
fc_forward:
    200, FMA (fused multiply-add) instruction(s) generated
malloc2D.c:

$ ./cnn-cifar10-prof 
Serial Code
CNN for 50000 images
Loading input batch 1...
Loading input batch 2...
Loading input batch 3...
Loading input batch 4...
Loading input batch 5...
Load Data time:2.346600 seconds
Create Network time:0.000000 seconds
Load Network Parameters time:0.008000 seconds
Create Ouputs time:0.000000 seconds

Net Forward total time:3213.477007 seconds
    Time for conv1: 1034.820460 seconds
    Time for relu1: 5.938601 seconds
    Time for pool1: 10.973933 seconds
    Time for conv2: 1665.419387 seconds
    Time for relu2: 1.807552 seconds
    Time for pool2: 3.242493 seconds
    Time for conv3: 488.184598 seconds
    Time for relu3: 0.493902 seconds
    Time for pool3: 0.963003 seconds
    Time for fc: 0.889915 seconds
    Time for softmax: 0.107188 seconds

  Conv: 3188.424445 seconds
  ReLU: 8.240055 seconds
  Pool: 15.179429 seconds
  FC:   0.889915 seconds
  Softmax: 0.107188 seconds

Net Accuracy: 78.84 % 
Net Accuracy time:0.004001 seconds
Free memory time:0.063994 seconds
Total time:3215.899602 seconds
END!
```

## Gprof
```
$ gprof ./cnn-cifar10-prof -b
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total           
 time   seconds   seconds    calls   s/call   s/call  name    
 99.29   3194.24  3194.24   150000     0.02     0.02  conv_forward
  0.46   3209.15    14.91   150000     0.00     0.00  pool_forward
  0.24   3216.97     7.82   150000     0.00     0.00  relu_forward
  0.07   3219.20     2.23        1     2.23     2.23  load_data
  0.03   3220.09     0.89    50000     0.00     0.00  fc_forward
  0.00   3220.13     0.04                             main
  0.00   3220.14     0.01    50000     0.00     0.00  softmax_forward
  0.00   3220.14     0.00        3     0.00     0.00  free_conv
  0.00   3220.14     0.00        3     0.00     0.00  free_pool
  0.00   3220.14     0.00        3     0.00     0.00  free_relu
  0.00   3220.14     0.00        3     0.00     0.00  load_conv
  0.00   3220.14     0.00        3     0.00     0.00  make_conv_layer
  0.00   3220.14     0.00        3     0.00     0.00  make_pool_layer
  0.00   3220.14     0.00        3     0.00     0.00  make_relu_layer
  0.00   3220.14     0.00        2     0.00     0.00  malloc2D
  0.00   3220.14     0.00        1     0.00     0.00  free_fc
  0.00   3220.14     0.00        1     0.00     0.00  free_softmax
  0.00   3220.14     0.00        1     0.00     0.00  load_fc
  0.00   3220.14     0.00        1     0.00     0.00  make_fc_layer
  0.00   3220.14     0.00        1     0.00     0.00  make_softmax_layer


                        Call graph


granularity: each sample hit covers 2 byte(s) for 0.00% of 3220.14 seconds

index % time    self  children    called     name
                                                 <spontaneous>
[1]    100.0    0.04 3220.10                 main [1]
             3194.24    0.00  150000/150000      conv_forward [2]
               14.91    0.00  150000/150000      pool_forward [3]
                7.82    0.00  150000/150000      relu_forward [4]
                2.23    0.00       1/1           load_data [5]
                0.89    0.00   50000/50000       fc_forward [6]
                0.01    0.00   50000/50000       softmax_forward [7]
                0.00    0.00       3/3           make_conv_layer [12]
                0.00    0.00       3/3           make_relu_layer [14]
                0.00    0.00       3/3           make_pool_layer [13]
                0.00    0.00       3/3           load_conv [11]
                0.00    0.00       3/3           free_pool [9]
                0.00    0.00       3/3           free_relu [10]
                0.00    0.00       3/3           free_conv [8]
                0.00    0.00       2/2           malloc2D [15]
                0.00    0.00       1/1           make_fc_layer [19]
                0.00    0.00       1/1           make_softmax_layer [20]
                0.00    0.00       1/1           load_fc [18]
                0.00    0.00       1/1           free_fc [16]
                0.00    0.00       1/1           free_softmax [17]
-----------------------------------------------
             3194.24    0.00  150000/150000      main [1]
[2]     99.2 3194.24    0.00  150000         conv_forward [2]
-----------------------------------------------
               14.91    0.00  150000/150000      main [1]
[3]      0.5   14.91    0.00  150000         pool_forward [3]
-----------------------------------------------
                7.82    0.00  150000/150000      main [1]
[4]      0.2    7.82    0.00  150000         relu_forward [4]
-----------------------------------------------
                2.23    0.00       1/1           main [1]
[5]      0.1    2.23    0.00       1         load_data [5]
-----------------------------------------------
                0.89    0.00   50000/50000       main [1]
[6]      0.0    0.89    0.00   50000         fc_forward [6]
-----------------------------------------------
                0.01    0.00   50000/50000       main [1]
[7]      0.0    0.01    0.00   50000         softmax_forward [7]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[8]      0.0    0.00    0.00       3         free_conv [8]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[9]      0.0    0.00    0.00       3         free_pool [9]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[10]     0.0    0.00    0.00       3         free_relu [10]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[11]     0.0    0.00    0.00       3         load_conv [11]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[12]     0.0    0.00    0.00       3         make_conv_layer [12]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[13]     0.0    0.00    0.00       3         make_pool_layer [13]
-----------------------------------------------
                0.00    0.00       3/3           main [1]
[14]     0.0    0.00    0.00       3         make_relu_layer [14]
-----------------------------------------------
                0.00    0.00       2/2           main [1]
[15]     0.0    0.00    0.00       2         malloc2D [15]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[16]     0.0    0.00    0.00       1         free_fc [16]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[17]     0.0    0.00    0.00       1         free_softmax [17]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[18]     0.0    0.00    0.00       1         load_fc [18]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[19]     0.0    0.00    0.00       1         make_fc_layer [19]
-----------------------------------------------
                0.00    0.00       1/1           main [1]
[20]     0.0    0.00    0.00       1         make_softmax_layer [20]
-----------------------------------------------


Index by function name

   [2] conv_forward           [11] load_conv              [14] make_relu_layer
   [6] fc_forward              [5] load_data              [20] make_softmax_layer
   [8] free_conv              [18] load_fc                [15] malloc2D
  [16] free_fc                 [1] main                    [3] pool_forward
   [9] free_pool              [12] make_conv_layer         [4] relu_forward
  [10] free_relu              [19] make_fc_layer           [7] softmax_forward
  [17] free_softmax           [13] make_pool_layer
```